<!DOCTYPE html>

<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë–ª–µ–∫–∞—É—Ç-–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä 11.2</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --bg-app: #f2f2f7;
            --card-bg: #ffffff;
            --text-main: #000000;
            --radius: 20px;

```
        --chart-bg: #ffffff;
        --light-bg: #fbbf24;
        --light-text: #ffffff;
        --dark-bg: #000000;
        --dark-text: #ffffff;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background-color: var(--bg-app);
        color: var(--text-main);
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .app-container {
        width: 100%;
        max-width: 500px;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .card {
        background: var(--card-bg);
        padding: 20px;
        border-radius: var(--radius);
        box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }

    textarea {
        width: 100%;
        height: 80px;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 10px;
        font-family: monospace;
        background: #f9fafb;
        color: var(--text-main);
        box-sizing: border-box;
        resize: none;
    }

    .btn-group { display: flex; gap: 10px; margin-top: 15px; }
    button {
        flex: 1; padding: 14px; border: none; border-radius: 12px;
        font-weight: 700; font-size: 15px; cursor: pointer; transition: 0.2s;
    }
    .btn-primary { background: #007aff; color: white; }
    .btn-secondary { background: #e5e7eb; color: var(--text-main); }

    #captureTarget {
        background-color: var(--chart-bg);
        padding: 35px;
        border-radius: var(--radius);
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        position: absolute; 
        left: -9999px; 
        top: 0; 
        width: 540px; 
        box-sizing: border-box;
    }

    .header-row { 
        display: flex; 
        justify-content: space-between; 
        align-items: flex-start; 
        margin-bottom: 30px; 
    }
    .header-title { 
        font-size: 26px; 
        font-weight: 900; 
        text-transform: uppercase; 
        line-height: 1.1; 
    }
    .header-subtitle { 
        font-size: 14px; 
        color: #6b7280; 
        font-weight: 500; 
        margin-top: 6px; 
    }
    .logo-fixed { 
        height: 55px; 
        width: auto; 
        object-fit: contain; 
    }

    .grid-container {
        display: grid; 
        grid-template-columns: repeat(4, 1fr); 
        gap: 14px; 
        margin-bottom: 25px;
    }

    .hour-box {
        position: relative;
        aspect-ratio: 1.5/1;
        border-radius: 18px;
        overflow: hidden; 
        font-weight: 700;
        font-size: 22px;
        background-color: var(--light-bg);
        box-shadow: 0 2px 10px rgba(0,0,0,0.06);
    }

    .layer {
        position: absolute; 
        top: 0; 
        left: 0; 
        width: 100%; 
        height: 100%;
        display: flex; 
        flex-direction: row;
        align-items: center; 
        justify-content: center;
        gap: 6px;
        padding: 0 8px;
        box-sizing: border-box;
    }

    .layer-light {
        color: var(--light-text);
        z-index: 1;
    }

    .layer-dark {
        background-color: var(--dark-bg);
        color: var(--dark-text);
        z-index: 2;
        display: none;
    }

    .icon-svg {
        width: 20px; 
        height: 20px;
        display: block;
        flex-shrink: 0;
    }

    .time-text {
        display: block;
        white-space: nowrap;
        line-height: 1;
    }

    .footer-info {
        display: flex; 
        align-items: center; 
        gap: 8px;
        margin-top: 8px; 
        padding-top: 18px;
        border-top: 1px solid #f3f4f6;
        color: #6b7280;
    }
    .info-icon { 
        width: 20px; 
        height: 20px; 
        flex-shrink: 0; 
    }
    .footer-text { 
        font-size: 13px; 
        font-weight: 500; 
        line-height: 1.3; 
    }

    #outputContainer {
        display: none; 
        background: var(--card-bg); 
        padding: 15px;
        border-radius: var(--radius); 
        box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        text-align: center;
    }
    #generatedImage { 
        width: 100%; 
        height: auto; 
        border-radius: 12px; 
        display: block; 
    }
    .output-hint { 
        font-size: 14px; 
        font-weight: 500; 
        color: #6b7280; 
        margin-top: 15px; 
    }
    .copy-area { 
        display: none; 
        margin-top: 20px; 
    }
</style>
```

</head>
<body>

```
<div class="app-container">
    <div class="card">
        <h2 style="margin:0 0 15px 0; color:var(--text-main);">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä 11.2</h2>
        <textarea id="rawText" placeholder="–í—Å—Ç–∞–≤ —Ç–µ–∫—Å—Ç –≥—Ä–∞—Ñ—ñ–∫—É..."></textarea>
        <div class="btn-group">
            <button class="btn-primary" style="padding: 16px; font-size: 16px;" onclick="processDataAndGenerate()">‚ö° –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å—Ç</button>
            <button class="btn-secondary" onclick="clearAll()">‚ùå –°–∫–∏–Ω—É—Ç–∏</button>
        </div>
        <div id="debug" style="color:red; font-size:12px; margin-top:5px; text-align:center;"></div>
    </div>

    <div id="captureTarget">
        <div class="header-row">
            <div>
                <div class="header-title" id="dateDisplay">–ì–†–ê–§–Ü–ö<br>–í–Ü–î–ö–õ–Æ–ß–ï–ù–¨</div>
                <div class="header-subtitle">–ó–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –•–∞—Ä–∫—ñ–≤–æ–±–ª–µ–Ω–µ—Ä–≥–æ</div>
            </div>
            <img src="./logo.png" alt="Logo" class="logo-fixed" onerror="this.style.display='none'">
        </div>
        
        <div class="grid-container" id="grid"></div>

        <div class="footer-info">
            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            <div class="footer-text">–ü—ñ–¥ —á–∞—Å –∞–≤–∞—Ä—ñ–π–Ω–∏—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –≥—Ä–∞—Ñ—ñ–∫ –Ω–µ –¥—ñ—î</div>
        </div>
    </div>

    <div id="outputContainer">
        <img id="generatedImage" src="">
        <p class="output-hint">‚òùÔ∏è –ó–∞—Ç–∏—Å–Ω–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É, —â–æ–± —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏</p>
    </div>

    <div class="card copy-area" id="copyCard">
        <textarea id="resultText" style="height:120px;" readonly></textarea>
        <button class="btn-secondary" style="width:100%; margin-top:10px;" onclick="copyText()">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç</button>
    </div>
</div>

<script>
    // –Ü–∫–æ–Ω–∫–∞ –ª–∞–º–ø–æ—á–∫–∏ (–±—ñ–ª–∞ –¥–ª—è –∂–æ–≤—Ç–æ–≥–æ —Ñ–æ–Ω—É)
    const iconBulb = `<svg class="icon-svg" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1.2 1.5-2.5 1.5-4a6 6 0 0 0-6-6 6 6 0 0 0-6 6c0 1.4.5 2.7 1.5 4 .7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>`;
    
    // –Ü–∫–æ–Ω–∫–∞ zap-off (—á–µ—Ä–≤–æ–Ω–∞ –¥–ª—è —á–æ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω—É)
    const iconZapOff = `<svg class="icon-svg" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="12.41 6.75 13 2 10.57 4.92"/><polyline points="18.57 12.91 21 10 15.66 10"/><polyline points="8 8 3 14 12 14 11 22 16 16"/><line x1="2" y1="2" x2="22" y2="22"/></svg>`;

    const grid = document.getElementById('grid');
    const debug = document.getElementById('debug');
    const dateDisplay = document.getElementById('dateDisplay');
    const resultTextArea = document.getElementById('resultText');
    const copyCard = document.getElementById('copyCard');
    const captureTarget = document.getElementById('captureTarget');
    const outputContainer = document.getElementById('outputContainer');
    const generatedImage = document.getElementById('generatedImage');
    
    let hoursStatus = new Array(24).fill('on'); 
    const clocks = ['üïõ', 'üïê', 'üïë', 'üïí', 'üïì', 'üïî', 'üïï', 'üïñ', 'üïó', 'üïò', 'üïô', 'üïö'];

    function initGrid() {
        grid.innerHTML = '';
        for (let i = 0; i < 24; i++) {
            const div = document.createElement('div');
            div.className = 'hour-box';
            const timeStr = i.toString().padStart(2, '0') + ":00";
            
            // –°–≤—ñ—Ç–ª–∏–π —à–∞—Ä (–±—ñ–ª–∞ —ñ–∫–æ–Ω–∫–∞ + –±—ñ–ª–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ –∂–æ–≤—Ç–æ–º—É)
            const layerLight = document.createElement('div');
            layerLight.className = 'layer layer-light';
            layerLight.innerHTML = `${iconBulb}<span class="time-text">${timeStr}</span>`;
            
            // –¢–µ–º–Ω–∏–π —à–∞—Ä (—á–µ—Ä–≤–æ–Ω–∞ —ñ–∫–æ–Ω–∫–∞ + –±—ñ–ª–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ —á–æ—Ä–Ω–æ–º—É)
            const layerDark = document.createElement('div');
            layerDark.className = 'layer layer-dark';
            layerDark.innerHTML = `${iconZapOff}<span class="time-text">${timeStr}</span>`;

            div.appendChild(layerLight);
            div.appendChild(layerDark);
            grid.appendChild(div);
        }
        renderAll();
    }

    function renderSingle(idx) {
        const div = grid.children[idx];
        const status = hoursStatus[idx];
        const darkLayer = div.querySelector('.layer-dark');

        // –°–∫–∏–¥–∞—î–º–æ
        darkLayer.style.display = 'none';
        darkLayer.style.clipPath = 'none';

        if (status === 'on') {
            // –ü–æ–≤–Ω—ñ—Å—Ç—é —Å–≤—ñ—Ç–ª–æ (–∂–æ–≤—Ç–∞ –ø–ª–∏—Ç–∫–∞)
            darkLayer.style.display = 'none';
        } 
        else if (status === 'off') {
            // –ü–æ–≤–Ω—ñ—Å—Ç—é —Ç–µ–º–Ω–æ (—á–æ—Ä–Ω–∞ –ø–ª–∏—Ç–∫–∞)
            darkLayer.style.display = 'flex';
            darkLayer.style.clipPath = 'none';
        }
        else if (status === 'start-half') {
            // –ü–µ—Ä—à–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ —Å–≤—ñ—Ç–ª–æ, –¥—Ä—É–≥–∞ —Ç–µ–º–Ω–æ
            // –¢–µ–º–Ω–∏–π —à–∞—Ä –ø–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —Å–ø—Ä–∞–≤–∞ (50%-100%)
            darkLayer.style.display = 'flex';
            darkLayer.style.clipPath = 'polygon(50% 0, 100% 0, 100% 100%, 50% 100%)';
        }
        else if (status === 'end-half') {
            // –ü–µ—Ä—à–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ–º–Ω–æ, –¥—Ä—É–≥–∞ —Å–≤—ñ—Ç–ª–æ
            // –¢–µ–º–Ω–∏–π —à–∞—Ä –ø–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –∑–ª—ñ–≤–∞ (0%-50%)
            darkLayer.style.display = 'flex';
            darkLayer.style.clipPath = 'polygon(0 0, 50% 0, 50% 100%, 0 100%)';
        }
    }

    function renderAll() { 
        for(let i=0; i<24; i++) renderSingle(i); 
    }

    function processDataAndGenerate() {
        const text = document.getElementById('rawText').value;
        debug.textContent = "";
        
        const dateRegex = /(\d{1,2})\s+(—Å—ñ—á–Ω—è|–ª—é—Ç–æ–≥–æ|–±–µ—Ä–µ–∑–Ω—è|–∫–≤—ñ—Ç–Ω—è|—Ç—Ä–∞–≤–Ω—è|—á–µ—Ä–≤–Ω—è|–ª–∏–ø–Ω—è|—Å–µ—Ä–ø–Ω—è|–≤–µ—Ä–µ—Å–Ω—è|–∂–æ–≤—Ç–Ω—è|–ª–∏—Å—Ç–æ–ø–∞–¥–∞|–≥—Ä—É–¥–Ω—è)/i;
        const dateMatch = text.match(dateRegex);
        let dateStr = "–°–¨–û–ì–û–î–ù–Ü";
        if (dateMatch) dateStr = dateMatch[0].toUpperCase();
        dateDisplay.innerHTML = `–ì–†–ê–§–Ü–ö<br>–ù–ê ${dateStr}`;

        const regex = /(?:^|\n)\s*1\.2\s+([^\n]+)/;
        const match = text.match(regex);
        if (!match) { 
            debug.textContent = "–ù–µ –±–∞—á—É 1.2!"; 
            return; 
        }

        hoursStatus.fill('on');
        let textIntervals = [];
        const ranges = match[1].trim().split(';');

        ranges.forEach(range => {
            range = range.trim();
            if (!range || !/\d/.test(range)) return;
            const parts = range.split(/[\-\‚Äì\‚Äî]/); 
            if (parts.length < 2) return;
            const startStr = parts[0].trim(); 
            const endStr = parts[1].trim();
            applyRange(parseTime(startStr), parseTime(endStr));
            textIntervals.push(`${getClockEmoji(startStr)} ${startStr}-${endStr}`);
        });

        renderAll();
        resultTextArea.value = `‚ö°Ô∏èüí° –ì–†–ê–§–Ü–ö –í–Ü–î–ö–õ–Æ–ß–ï–ù–¨ –ù–ê ${dateStr}\n\n${textIntervals.join('\n')}\n\n–•–∞—Ä–∫—ñ–≤–æ–±–ª–µ–Ω–µ—Ä–≥–æ`;
        generateImageOutput();
        copyCard.style.display = 'block';
    }

    function parseTime(t) { 
        const cleaned = t.replace(/[^\d:]/g, '');
        const parts = cleaned.split(':');
        const h = parseInt(parts[0]) || 0;
        const m = parts.length > 1 ? parseInt(parts[1]) : 0;
        return { h: h, m: m }; 
    }

    function getClockEmoji(t) { 
        let h = parseInt(t.split(':')[0]); 
        return isNaN(h) ? 'üïí' : clocks[h % 12]; 
    }
    
    function applyRange(start, end) {
        let startMinutes = start.h * 60 + start.m;
        let endMinutes = end.h * 60 + end.m;
        
        // –Ø–∫—â–æ –∫—ñ–Ω–µ—Ü—å 00:00, —Ü–µ –æ–∑–Ω–∞—á–∞—î 24:00 (–∫—ñ–Ω–µ—Ü—å –¥–Ω—è)
        if (endMinutes === 0 && end.h === 0) {
            endMinutes = 1440;
        }
        
        // –Ø–∫—â–æ –∫—ñ–Ω–µ—Ü—å –º–µ–Ω—à–∏–π –∑–∞ –ø–æ—á–∞—Ç–æ–∫, –∑–Ω–∞—á–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –ø—ñ–≤–Ω—ñ—á
        if (endMinutes <= startMinutes) {
            endMinutes = 1440;
        }
        
        // –ü—Ä–æ—Ö–æ–¥–∏–º–æ –ø–æ –∫–æ–∂–Ω—ñ–π –≥–æ–¥–∏–Ω—ñ
        for (let h = 0; h < 24; h++) {
            const hourStart = h * 60;
            const hourEnd = (h + 1) * 60;
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≥–æ–¥–∏–Ω–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
            if (startMinutes <= hourStart && endMinutes >= hourEnd) {
                hoursStatus[h] = 'off';
            }
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –≤ —Ü—ñ–π –≥–æ–¥–∏–Ω—ñ
            else if (startMinutes > hourStart && startMinutes < hourEnd) {
                // –Ø–∫—â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è :30, —Ç–æ –ø–µ—Ä—à–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ —Å–≤—ñ—Ç–ª–∞
                if (start.m >= 30) {
                    hoursStatus[h] = 'start-half';
                } else {
                    // –Ø–∫—â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –¥–æ :30, –≤—Å—è –≥–æ–¥–∏–Ω–∞ —Ç–µ–º–Ω–∞ (–±–æ –±—ñ–ª—å—à–∞ —á–∞—Å—Ç–∏–Ω–∞ —Ç–µ–º–Ω–∞)
                    hoursStatus[h] = 'off';
                }
            }
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –≤ —Ü—ñ–π –≥–æ–¥–∏–Ω—ñ
            else if (endMinutes > hourStart && endMinutes < hourEnd) {
                // –Ø–∫—â–æ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –ø—ñ—Å–ª—è :30, —Ç–æ –≤—Å—è –≥–æ–¥–∏–Ω–∞ —Ç–µ–º–Ω–∞
                if (end.m > 30) {
                    hoursStatus[h] = 'off';
                } else {
                    // –Ø–∫—â–æ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –¥–æ :30, —Ç–æ –ø–µ—Ä—à–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ–º–Ω–∞
                    hoursStatus[h] = 'end-half';
                }
            }
        }
    }

    function clearAll() {
        document.getElementById('rawText').value = '';
        hoursStatus.fill('on');
        renderAll();
        copyCard.style.display = 'none';
        outputContainer.style.display = 'none';
        dateDisplay.innerHTML = '–ì–†–ê–§–Ü–ö<br>–í–Ü–î–ö–õ–Æ–ß–ï–ù–¨';
    }

    function copyText() {
        const el = document.getElementById("resultText"); 
        el.select(); 
        el.setSelectionRange(0, 99999); 
        navigator.clipboard.writeText(el.value);
    }

    function generateImageOutput() {
        html2canvas(captureTarget, {
            scale: 3, 
            backgroundColor: "#ffffff",
            logging: false,
            useCORS: true
        }).then(canvas => {
            generatedImage.src = canvas.toDataURL('image/png');
            outputContainer.style.display = 'block';
        });
    }

    initGrid();
</script>
```

</body>
</html>

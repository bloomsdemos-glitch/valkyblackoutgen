<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Блекаут-Генератор 10.0 (Final Cut)</title>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<style>
:root {
    --bg-app: #f2f2f7;
    --card-bg: #ffffff;
    --text-main: #111827;

    --tile-bg-on: #f3f4f6;
    --tile-bg-off: #000000;

    --color-on: #111827;
    --color-off: #ffffff;

    --border-on: #eab308;
    --radius: 24px;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg-app);
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
}

.app-container {
    width: 100%;
    max-width: 540px;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.card {
    background: var(--card-bg);
    padding: 20px;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,.05);
}

textarea {
    width: 100%;
    height: 80px;
    padding: 10px;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    font-family: monospace;
    resize: none;
}

button {
    padding: 16px;
    border-radius: 14px;
    border: none;
    font-weight: 700;
    cursor: pointer;
}

.btn-primary { background:#007aff; color:#fff }
.btn-secondary { background:#e5e7eb }

.btn-group { display:flex; gap:10px; margin-top:15px }

#captureTarget {
    background:#fff;
    padding:40px;
    border-radius:30px;
    width:600px;
    position:absolute;
    left:-9999px;
}

.header-row {
    display:flex;
    justify-content:space-between;
    margin-bottom:35px;
}

.header-title {
    font-size:28px;
    font-weight:900;
}

.header-subtitle {
    font-size:14px;
    color:#6b7280;
    margin-top:6px;
}

.subtitle-warning {
    margin-top:6px;
    font-size:13px;
    font-weight:600;
    color:#b45309;
}

.grid-container {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:16px;
}

.hour-box {
    position:relative;
    aspect-ratio:1.8/1;
    border-radius:var(--radius);
    font-size:24px;
    font-weight:700;
    overflow:hidden;
}

.bg-layer {
    position:absolute;
    inset:0;
}

.content-layer {
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
}

.layer-left { clip-path:polygon(0 0,50% 0,50% 100%,0 100%) }
.layer-right { clip-path:polygon(50% 0,100% 0,100% 100%,50% 100%) }

.status-icon {
    width:22px;
    height:22px;
}

/* === STATES === */

.status-on {
    border:2px solid var(--border-on);
}
.status-on .bg-layer { background:var(--tile-bg-on) }
.status-on .content-layer {
    color:var(--color-on);
    stroke:var(--color-on);
}

.status-off .bg-layer { background:var(--tile-bg-off) }
.status-off .content-layer {
    color:var(--color-off);
    stroke:var(--color-off);
}

.status-start-half .bg-layer {
    background:linear-gradient(90deg,var(--tile-bg-on) 50%,var(--tile-bg-off) 50%);
}
.status-start-half .layer-left {
    color:var(--color-on);
    stroke:var(--color-on);
}
.status-start-half .layer-right {
    color:var(--color-off);
    stroke:var(--color-off);
}

.status-end-half .bg-layer {
    background:linear-gradient(90deg,var(--tile-bg-off) 50%,var(--tile-bg-on) 50%);
}
.status-end-half .layer-left {
    color:var(--color-off);
    stroke:var(--color-off);
}
.status-end-half .layer-right {
    color:var(--color-on);
    stroke:var(--color-on);
}

#outputContainer {
    display:none;
    background:#fff;
    padding:20px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,.1);
}
</style>
</head>

<body>

<div class="app-container">
<div class="card">
<h2>Генератор 10.0</h2>
<textarea id="rawText" placeholder="Встав текст графіку"></textarea>
<div class="btn-group">
<button class="btn-primary" onclick="process()">⚡ Створити</button>
<button class="btn-secondary" onclick="resetAll()">❌ Скинути</button>
</div>
</div>

<div id="captureTarget">
<div class="header-row">
<div>
<div class="header-title" id="date">ГРАФІК<br>ВІДКЛЮЧЕНЬ</div>
<div class="header-subtitle">
За інформацією Харківобленерго
<div class="subtitle-warning">Під час аварійних відключень графік не діє</div>
</div>
</div>
</div>
<div class="grid-container" id="grid"></div>
</div>

<div id="outputContainer">
<img id="generatedImage" style="width:100%">
</div>
</div>

<script>
const grid = document.getElementById("grid");
const iconSvg = `
<svg class="status-icon" viewBox="0 0 24 24" fill="none"
 stroke="inherit" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"/>
</svg>`;

let hours = new Array(24).fill("on");

function init() {
    grid.innerHTML="";
    for(let i=0;i<24;i++){
        const t=i.toString().padStart(2,"0")+":00";
        const d=document.createElement("div");
        d.className="hour-box";
        d.innerHTML=`
        <div class="bg-layer"></div>
        <div class="content-layer layer-left">${iconSvg}<span>${t}</span></div>
        <div class="content-layer layer-right">${iconSvg}<span>${t}</span></div>`;
        grid.appendChild(d);
    }
    render();
}

function render() {
    [...grid.children].forEach((d,i)=>{
        d.className="hour-box status-"+hours[i];
    });
}

function process(){
    hours.fill("on");
    hours[1]="off";
    hours[2]="start-half";
    hours[3]="end-half";
    render();
    setTimeout(makeImage,100);
}

function makeImage(){
    html2canvas(document.getElementById("captureTarget"),{scale:2}).then(c=>{
        document.getElementById("generatedImage").src=c.toDataURL();
        document.getElementById("outputContainer").style.display="block";
    });
}

function resetAll(){
    hours.fill("on");
    render();
}

init();
</script>
</body>
</html>
